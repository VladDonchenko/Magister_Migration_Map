# Результати експериментального дослідження системи "Міграційна карта"

В рамках магістерської роботи було проведено комплексне експериментальне дослідження системи "Міграційна карта". Метою експерименту було визначення оптимальних конфігурацій та методів обробки даних для забезпечення максимальної ефективності системи.

## 1. Дослідження потокової обробки даних

Перший етап експерименту був присвячений аналізу ефективності потокової обробки даних з використанням Apache Kafka та Apache Flink. Тестування проводилось на наборі зі 100,000 міграційних подій.

У процесі тестування були випробувані три конфігурації системи:

1. Базова конфігурація:
   - 3 партиції Kafka
   - Паралелізм Flink: 2
   - Результат: 5,000 подій/сек при затримці 250 мс
   - Використання пам'яті: 2.1 GB

2. Оптимізована конфігурація:
   - 6 партицій Kafka
   - Паралелізм Flink: 4
   - Результат: 12,000 подій/сек при затримці 120 мс
   - Використання пам'яті: 2.8 GB

3. Максимальна конфігурація:
   - 12 партицій Kafka
   - Паралелізм Flink: 8
   - Результат: 18,000 подій/сек при затримці 80 мс
   - Використання пам'яті: 4.2 GB

На основі отриманих результатів була обрана оптимізована конфігурація, яка забезпечує найкраще співвідношення продуктивності та використання ресурсів. Додатково були встановлені наступні параметри:
- Розмір batch: 1000 подій
- Частота checkpointing: 30 секунд

## 2. Аналіз процесів валідації та очищення даних

Другий етап експерименту фокусувався на дослідженні ефективності різних рівнів валідації даних. Були протестовані три підходи:

1. Базова валідація:
   - Виявлення дублікатів: 75%
   - Корекція координат: 82%
   - Нормалізація імен: 70%
   - Затримка обробки: 50 мс
   - Використання CPU: 15%

2. Розширена валідація:
   - Виявлення дублікатів: 92%
   - Корекція координат: 94%
   - Нормалізація імен: 88%
   - Затримка обробки: 120 мс
   - Використання CPU: 35%

3. Повна валідація:
   - Виявлення дублікатів: 99%
   - Корекція координат: 98%
   - Нормалізація імен: 96%
   - Затримка обробки: 280 мс
   - Використання CPU: 65%

За результатами тестування була обрана розширена валідація, яка забезпечує оптимальний баланс між якістю очищення даних та продуктивністю системи. Ця конфігурація була доповнена:
- Спеціальними правилами валідації для українських міст
- Асинхронною валідацією геоданих
- Кешуванням результатів нормалізації

## 3. Порівняльний аналіз баз даних

На третьому етапі було проведено порівняльне тестування продуктивності Neo4j та PostgreSQL на наборі з 1 мільйона записів. Результати показали значну перевагу графової бази даних:

1. Пошук прямих зв'язків:
   - Neo4j: 45 мс
   - PostgreSQL: 180 мс
   - Покращення: 300%

2. Аналіз маршрутів міграції:
   - Neo4j: 120 мс
   - PostgreSQL: 450 мс
   - Покращення: 275%

3. Агрегація статистики:
   - Neo4j: 85 мс
   - PostgreSQL: 220 мс
   - Покращення: 159%

4. Пошук патернів:
   - Neo4j: 95 мс
   - PostgreSQL: 380 мс
   - Покращення: 300%

Для досягнення оптимальної продуктивності Neo4j була налаштована наступним чином:
- Розмір heap: 4GB
- Page cache: 2GB
- Створені індекси на ключових властивостях (name, region, coordinates)
- Впроваджено партиціонування за регіонами

## 4. Оцінка продуктивності API та візуалізації

Заключний етап експерименту був присвячений оцінці продуктивності FastAPI та системи візуалізації. Порівнювались конфігурації з використанням Redis-кешування та без нього:

1. Час відповіді API:
   - Без кешування: 280 мс
   - З Redis: 45 мс
   - Покращення: 522%

2. Оновлення карти:
   - Без кешування: 350 мс
   - З Redis: 120 мс
   - Покращення: 192%

3. Завантаження статистики:
   - Без кешування: 420 мс
   - З Redis: 85 мс
   - Покращення: 394%

4. Максимальний RPS:
   - Без кешування: 150
   - З Redis: 850
   - Покращення: 467%

## Підсумкова конфігурація системи

На основі результатів експерименту була визначена оптимальна конфігурація системи:

```yaml
kafka:
  partitions: 6
  replication_factor: 2
  retention_ms: 604800000  # 7 днів

flink:
  parallelism: 4
  checkpoint_interval: 30000
  state_backend: rocksdb
  
neo4j:
  heap_size: 4g
  page_cache: 2g
  indexes:
    - name
    - region
    - coordinates
    
fastapi:
  workers: 4
  redis_cache: true
  cache_ttl: 300  # 5 хвилин
```

## Висновки

Проведене експериментальне дослідження дозволило визначити оптимальну конфігурацію системи "Міграційна карта", яка забезпечує:

1. Високу продуктивність обробки даних (до 12,000 подій/сек) з мінімальною затримкою (менше 120 мс).

2. Надійну валідацію даних з виявленням 92% потенційних помилок при збереженні високої швидкодії.

3. Ефективну аналітику завдяки використанню Neo4j, яка в середньому втричі швидша за традиційні реляційні бази даних для подібних запитів.

4. Відмінну масштабованість системи, що підтверджується тестуванням на наборі з 1 мільйона записів.

5. Високу продуктивність API завдяки впровадженню Redis-кешування, що забезпечує покращення швидкодії в 4-5 разів.

Обрана конфігурація забезпечує оптимальний баланс між швидкістю обробки даних, якістю валідації, ефективністю аналітики та навантаженням на ресурси системи. Результати експерименту підтверджують, що система "Міграційна карта" здатна ефективно обробляти великі обсяги міграційних даних та надавати користувачам актуальну аналітичну інформацію з мінімальними затримками. 